<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Oxidation Number Quiz - San Francisco de Paula</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: #eef4ff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }

    #revisionBanner {
      display: none;
      background: #ff8c00;
      color: white;
      padding: 8px 20px;
      border-radius: 10px;
      font-weight: bold;
      box-shadow: 0 2px 8px rgba(255, 140, 0, 0.4);
      margin-bottom: 10px;
    }

    .card {
      background: white;
      border-radius: 16px;
      padding: 25px 35px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      text-align: center;
      width: 360px;
      border: 3px solid transparent;
      transition: border 0.3s, box-shadow 0.3s;
    }
    #correctPage.card {
      width: 650px !important; /* wider only for the correct page */
    }

    h1 { font-size: 1.3em; margin-bottom: 10px; }

    input[type="text"] {
      width: 80%;
      padding: 8px;
      font-size: 1em;
      margin-top: 10px;
    }

    .numbers {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
      margin-top: 10px;
    }

    label { font-size: 0.9em; }

    button {
      background: #006aff;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px 18px;
      font-size: 1em;
      cursor: pointer;
      margin-top: 15px;
    }

    button:hover { background: #004fcc; }

    #feedback { margin-top: 10px; font-weight: bold; }

    /* Correct answers grid */
    #correctList {
      display: grid;
      grid-template-columns: repeat(7, 1fr   );
      gap: 10px;
      margin-top: 10px;
    }

    .list-item {
      background: #f2f5ff;
      border-radius: 6px;
      padding: 8px;
      font-size: 0.95em;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .list-item button {
      background: #ff6b6b;
      font-size: 0.8em;
      padding: 4px 8px;
      margin-top: 4px;
    }

    #wrongList .list-item {
      background: #fff0e0;
    }

    /* Revision mode visuals */
    .revision .card {
      border: 3px solid #ff8c00;
      box-shadow: 0 4px 20px rgba(255, 140, 0, 0.4);
    }

    .revision button {
      background: #ff8c00;
    }

    .revision button:hover {
      background: #e07800;
    }
      #correctPage,
  #summaryPage {
    display: none;
  }
  </style>
</head>
<body>
  <div id="revisionBanner">🔸 Revision Mode</div>

  <!-- MAIN QUIZ -->
  <div class="card" id="quizPage">
    <h1 id="question">Loading...</h1>
    <div id="input-area"></div>
    <div class="numbers"></div>
    <button id="submit">Submit</button>
    <p id="feedback"></p>
    <button id="viewCorrect">View Correct Answers</button>
  </div>

  <!-- CORRECT ANSWERS PAGE -->
  <div class="card" id="correctPage">
    <h1>Correct Answers</h1>
    <div id="correctList"></div>
    <button id="revise">Revise Correct Ones</button>
    <button id="back">Back to Quiz</button>
  </div>

  <!-- SUMMARY PAGE -->
  <div class="card" id="summaryPage">
    <h1>Revision Summary</h1>
    <p id="summaryText"></p>
    <div id="wrongList"></div>
    <button id="backToCorrect">Back to Correct List</button>
  </div>

  <script>
    const elements = [
      // --- Alkali Metals (+1) ---
      { name: "Lithium", symbol: "Li", ox: [+1] },
      { name: "Sodium", symbol: "Na", ox: [+1] },
      { name: "Potassium", symbol: "K", ox: [+1] },
      { name: "Rubidium", symbol: "Rb", ox: [+1] },
      { name: "Caesium", symbol: "Cs", ox: [+1] },
      { name: "Francium", symbol: "Fr", ox: [+1] },
      // --- Alkaline Earth (+2) ---
      { name: "Beryllium", symbol: "Be", ox: [+2] },
      { name: "Magnesium", symbol: "Mg", ox: [+2] },
      { name: "Calcium", symbol: "Ca", ox: [+2] },
      { name: "Strontium", symbol: "Sr", ox: [+2] },
      { name: "Barium", symbol: "Ba", ox: [+2] },
      { name: "Radium", symbol: "Ra", ox: [+2] },
      // --- Earth Metals (+3) ---
      { name: "Boron", symbol: "B", ox: [+3] },
      { name: "Aluminium", symbol: "Al", ox: [+3] },
      { name: "Gallium", symbol: "Ga", ox: [+3] },
      { name: "Indium", symbol: "In", ox: [+3] },
      { name: "Thallium", symbol: "Tl", ox: [+3] },
      // --- Transition Metals ---
      { name: "Silver", symbol: "Ag", ox: [+1] },
      { name: "Zinc", symbol: "Zn", ox: [+2] },
      { name: "Copper", symbol: "Cu", ox: [+1, +2] },
      { name: "Mercury", symbol: "Hg", ox: [+1, +2] },
      { name: "Gold", symbol: "Au", ox: [+1, +3] },
      { name: "Iron", symbol: "Fe", ox: [+2, +3] },
      { name: "Cobalt", symbol: "Co", ox: [+2, +3] },
      { name: "Nickel", symbol: "Ni", ox: [+2, +3] },
      { name: "Chromium", symbol: "Cr", ox: [+2, +3, +6] },
      { name: "Manganese", symbol: "Mn", ox: [+2, +3, +4, +6, +7] },
      { name: "Platinum", symbol: "Pt", ox: [+2, +4] },
      { name: "Palladium", symbol: "Pd", ox: [+2, +4] },
      { name: "Titanium", symbol: "Ti", ox: [+4] },
      { name: "Cadmium", symbol: "Cd", ox: [+2] },
      // --- Groups IV, V, VI ---
      { name: "Carbon", symbol: "C", ox: [+2, +4] },
      { name: "Silicon", symbol: "Si", ox: [+2, +4] },
      { name: "Germanium", symbol: "Ge", ox: [+2, +4] },
      { name: "Tin", symbol: "Sn", ox: [+2, +4] },
      { name: "Lead", symbol: "Pb", ox: [+2, +4] },
      { name: "Nitrogen", symbol: "N", ox: [-3, +3, +5] },
      { name: "Phosphorus", symbol: "P", ox: [-3, +3, +5] },
      { name: "Arsenic", symbol: "As", ox: [-3, +3, +5] },
      { name: "Oxygen", symbol: "O", ox: [-2, +1, +2] },
      { name: "Sulfur", symbol: "S", ox: [-2, +2, +4, +6] },
      { name: "Selenium", symbol: "Se", ox: [-2, +2, +4, +6] },
      { name: "Tellurium", symbol: "Te", ox: [-2, +2, +4, +6] },
      // --- Halogens ---
      { name: "Fluorine", symbol: "F", ox: [-1] },
      { name: "Chlorine", symbol: "Cl", ox: [-1, +1, +3, +5, +7] },
      { name: "Bromine", symbol: "Br", ox: [-1, +1, +3, +5, +7] },
      { name: "Iodine", symbol: "I", ox: [-1, +1, +3, +5, +7] },
      { name: "Astatine", symbol: "At", ox: [-1, +1, +3, +5, +7] },
      // --- Noble Gases ---
      { name: "Helium", symbol: "He", ox: [0] },
      { name: "Neon", symbol: "Ne", ox: [0] },
      { name: "Argon", symbol: "Ar", ox: [0] },
      { name: "Krypton", symbol: "Kr", ox: [0] },
      { name: "Xenon", symbol: "Xe", ox: [0] },
      { name: "Radon", symbol: "Rn", ox: [0] }
    ];

    let correctList = JSON.parse(localStorage.getItem("correctList") || "[]");
    let streaks = JSON.parse(localStorage.getItem("streaks") || "{}");
    let revisionMode = false;
    let revisionQueue = [];
    let wrongRevision = [];
    let current, askSymbol;

    const quizPage = document.getElementById("quizPage");
    const correctPage = document.getElementById("correctPage");
    const summaryPage = document.getElementById("summaryPage");
    const revisionBanner = document.getElementById("revisionBanner");

    function saveProgress() {
      localStorage.setItem("correctList", JSON.stringify(correctList));
      localStorage.setItem("streaks", JSON.stringify(streaks));
    }

    function newQuestion() {
      document.getElementById("feedback").textContent = "";
      let pool;
      if (revisionMode) {
        pool = revisionQueue.length ? revisionQueue : correctList;
        pool = elements.filter(e => pool.includes(e.symbol));
      } else {
        pool = elements.filter(e => !correctList.includes(e.symbol));
        if (pool.length === 0) pool = elements;
      }

      current = pool[Math.floor(Math.random() * pool.length)];
      askSymbol = Math.random() > 0.5;

      const numDiv = document.querySelector(".numbers");
      numDiv.innerHTML = "";
      for (let i = -3; i <= 7; i++) {
        const cb = document.createElement("input");
        cb.type = "checkbox";
        cb.value = i;
        const label = document.createElement("label");
        label.textContent = (i > 0 ? "+" + i : i);
        const wrap = document.createElement("div");
        wrap.appendChild(cb);
        wrap.appendChild(label);
        numDiv.appendChild(wrap);
      }

      const q = document.getElementById("question");
      const inputArea = document.getElementById("input-area");
      if (askSymbol) {
        q.textContent = `What is the name of "${current.symbol}"?`;
        inputArea.innerHTML = `<input id="answer" type="text" placeholder="Element name">`;
      } else {
        q.textContent = `What is the symbol of "${current.name}"?`;
        inputArea.innerHTML = `<input id="answer" type="text" placeholder="Symbol">`;
      }
    }

    document.getElementById("submit").addEventListener("click", () => {
      const userAnswer = document.getElementById("answer").value.trim();
      const selected = Array.from(document.querySelectorAll(".numbers input:checked"))
        .map(c => Number(c.value));

      const correctName = askSymbol
        ? userAnswer.toLowerCase() === current.name.toLowerCase()
        : userAnswer.toLowerCase() === current.symbol.toLowerCase();

      const correctOx = selected.length === current.ox.length &&
        selected.every(n => current.ox.includes(n));

      const feedback = document.getElementById("feedback");
      const correct = correctName && correctOx;

      if (correct) {
        feedback.textContent = "✅ Correct!";
        feedback.style.color = "green";

        if (!revisionMode) {
          streaks[current.symbol] = (streaks[current.symbol] || 0) + 1;
          if (streaks[current.symbol] >= 3 && !correctList.includes(current.symbol)) {
            correctList.push(current.symbol);
            feedback.textContent += " (Added to Correct List)";
          }
        }
      } else {
        feedback.innerHTML = `❌ Incorrect.<br>${current.symbol} = ${current.name}<br>Oxidation: ${current.ox.map(n => n>0? "+"+n:n).join(", ")}`;
        feedback.style.color = "red";
        wrongRevision.push(current.symbol);

        if (revisionMode) {
          correctList = correctList.filter(s => s !== current.symbol);
        } else {
          streaks[current.symbol] = 0;
        }
      }

      saveProgress();

      if (revisionMode) {
        revisionQueue = revisionQueue.filter(sym => sym !== current.symbol);
        if (revisionQueue.length === 0) {
          setTimeout(showSummary, 2000);
          return;
        }
      }

      setTimeout(newQuestion, 2000);
    });

    document.getElementById("viewCorrect").onclick = () => {
      quizPage.style.display = "none";
      correctPage.style.display = "block";
      renderCorrectList();
    };

    document.getElementById("back").onclick = () => {
        revisionMode = false; // ✅ ensure reset
        document.body.classList.remove("revision");
        revisionBanner.style.display = "none";
        summaryPage.style.display = "none";
        correctPage.style.display = "none";
        quizPage.style.display = "block";
        newQuestion();
    };


    function renderCorrectList() {
      const list = document.getElementById("correctList");
      list.innerHTML = "";
      correctList.forEach(sym => {
        const el = elements.find(e => e.symbol === sym);
        if (!el) return;
        const div = document.createElement("div");
        div.className = "list-item";
        div.innerHTML = `<span><b>${el.symbol}</b><br>${el.name}</span>
        <button data-sym="${el.symbol}" class="remove">Remove</button>`;
        list.appendChild(div);
      });
      document.querySelectorAll(".remove").forEach(btn => {
        btn.onclick = e => {
          const sym = e.target.dataset.sym;
          correctList = correctList.filter(s => s !== sym);
          saveProgress();
          renderCorrectList();
        };
      });
    }

    document.getElementById("revise").onclick = () => {
      if (correctList.length === 0) return alert("No correct items to revise!");
      revisionMode = true;
      wrongRevision = [];
      revisionQueue = [...correctList];
      correctPage.style.display = "none";
      quizPage.style.display = "block";
      document.body.classList.add("revision");
      revisionBanner.style.display = "block";
      newQuestion();
    };

    function showSummary() {
    quizPage.style.display = "none";
    summaryPage.style.display = "block";
    correctPage.style.display = "none";
    document.body.classList.remove("revision");
    revisionBanner.style.display = "none";
    revisionMode = false; // ✅ reset mode

    const list = document.getElementById("wrongList");
    list.innerHTML = "";
    document.getElementById("summaryText").textContent =
        `You missed ${wrongRevision.length} out of ${correctList.length + wrongRevision.length} elements.`;

    wrongRevision.forEach(sym => {
        const el = elements.find(e => e.symbol === sym);
        const div = document.createElement("div");
        div.className = "list-item";
        div.innerHTML = `<span>${el.symbol} = ${el.name}</span>
        <button data-sym="${el.symbol}" class="remove">Remove from Correct</button>`;
        list.appendChild(div);
    });

    document.querySelectorAll("#wrongList .remove").forEach(btn => {
        btn.onclick = e => {
        const sym = e.target.dataset.sym;
        correctList = correctList.filter(s => s !== sym);
        saveProgress();
        e.target.parentElement.remove();
        };
    });
    }


    document.getElementById("backToCorrect").onclick = () => {
      summaryPage.style.display = "none";
      correctPage.style.display = "block";
      renderCorrectList();
    };

    newQuestion();
  </script>
</body>
</html>
